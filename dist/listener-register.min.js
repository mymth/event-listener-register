!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).listenerRegsiter={})}(this,function(e){"use strict";const t=new WeakMap;function r(e,t){const r=e.indexOf(".");return r<0?[e,t&&"string"==typeof t?t:void 0]:[e.slice(0,r),e.slice(r+1)]}function n(e){return!!("object"==typeof e?e.capture:e)}class i{constructor(e){this.target=e,this.registry=t.get(e)}prepare(){return this.registry||(this.registry={},t.set(this.target,this.registry)),this}add(e,t){const i="string"==typeof t[1]&&void 0===t[2],[s,a]=r(e,i?t[1]:t[2]);let o=this.registry[s];if(o){if(a&&a in o.byName)return!1}else o=this.registry[s]={forBubble:new Set,forCapture:new Set,byName:{}};const f=t[0],c=i?void 0:t[1],u=n(c);return(e=>!e.has(f)&&(this.target.addEventListener(s,f,c),e.add(f),a&&(o.byName[a]={fn:f,capture:u}),!0))(u?o.forCapture:o.forBubble)}remove(e,t){const[i,s]=r(e,t[0]),a=this.registry[i];if(!a)return;let o;if(s){if(!a.byName[s])return;o=Object.assign({name:s},a.byName[s])}else{if(!t[0]){if(!(a.forBubble.size+a.forCapture.size))return;return a.forBubble.forEach(e=>{this.target.removeEventListener(i,e,!1)}),a.forCapture.forEach(e=>{this.target.removeEventListener(i,e,!0)}),a.forBubble.clear(),a.forCapture.clear(),void(a.byName={})}(o={fn:t[0],capture:n(t[1])}).name=Object.keys(a.byName).find(e=>{const t=a.byName[e];return t.fn===o.fn&&t.capture===o.capture})}(e=>{e.has(o.fn)&&(this.target.removeEventListener(i,o.fn,o.capture),e.delete(o.fn),o.name&&delete a.byName[o.name])})(o.capture?a.forCapture:a.forBubble)}}e.addListener=function(e,t,r,n,s){const a=new i(e).prepare(),o=e=>{const t=e[0].split(" "),r=e.slice(1);return t.length>1?t.map(e=>a.add(e,r)):a.add(t[0],r)};return"string"==typeof t?o([t,r,n,s]):Array.isArray(t)?t.map(o):Object.entries(t).reduce((e,t)=>(e[t[0]]=o(t),e),{})},e.removeListener=function(e,t,r,n){const s=new i(e);if(!s.registry)return;const a=e=>{const t=e.slice(1);e[0].split(" ").forEach(e=>s.remove(e,t))};"string"==typeof t?a([t,r,n]):Array.isArray(t)?t.forEach(e=>{a(Array.isArray(e)?e:[e])}):Object.entries(t).forEach(a)},Object.defineProperty(e,"__esModule",{value:!0})});